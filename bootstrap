#!/bin/bash

###### This is the dotfiles bootstrap. 
####### It symlinks and creates config dirs for all the things.
####### Run this once after pulling dotfiles to ~/bin/dotfiles.

####### First provision the Mac
if [[ $1 == "--provision" ]]; then
    sh provision.sh
else
    echo "Not provisioning..."
fi

# Create necessary directories
mkdir -p ~/.config

######### bash & zsh config-fu ##########
cp  ~/bin/dotfiles/zshrc ~/.zshrc

######### ruby ###########
ln -nfs ~/bin/dotfiles/ruby/irbrc ~/.irbrc
ln -nfs ~/bin/dotfiles/ruby/pryrc ~/.pryrc
ln -nfs ~/bin/dotfiles/ruby/gemrc ~/.gemrc

######### git ############
ln -nfs ~/bin/dotfiles/git/config ~/.gitconfig
ln -nfs ~/bin/dotfiles/git/gitignore_global ~/.gitignore_global

######### neovim (modern config) ############
# Remove existing nvim config and create fresh symlink
rm -rf ~/.config/nvim
ln -nfs ~/bin/dotfiles/nvim ~/.config/nvim

######### tmux ###########
mkdir -p ~/.bin
ln -nfs ~/bin/dotfiles/tmux/tmuxinator.sh  ~/.bin/tmuxinator.sh
ln -nfs ~/bin/dotfiles/tmux/tmuxinator  ~/.config/tmuxinator
ln -nfs ~/bin/dotfiles/tmux/tmux.conf ~/.tmux.conf
ln -nfs ~/bin/dotfiles/tmux/tmuxinator ~/.tmuxinator

######### pgcli ############
mkdir -p ~/.config/pgcli
ln -nfs ~/bin/dotfiles/postgres/pgcli/config ~/.config/pgcli/config

######### mycli ############
ln -nfs ~/bin/dotfiles/mysql/mycli/config ~/.myclirc

######### node ############
ln -nfs ~/bin/dotfiles/node/npmrc ~/.npmrc  

######### ssh ############
mkdir -p ~/.ssh
ln -nfs ~/bin/dotfiles/ssh/config ~/.ssh/config

######### starship prompt ############
mkdir -p ~/.config
ln -nfs ~/bin/dotfiles/starship/starship.toml ~/.config/starship.toml

######### local config not to be stored in VCS ########
mkdir -p ~/bin/dotfiles/local
touch ~/bin/dotfiles/local/local_aliases
touch ~/bin/dotfiles/local/local_env
touch ~/bin/dotfiles/local/local_scripts

echo "Bootstrap complete! Run 'source ~/.zshrc' to reload shell configuration."
